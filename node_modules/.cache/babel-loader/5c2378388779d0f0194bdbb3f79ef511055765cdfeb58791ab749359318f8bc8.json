{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import $ from'jquery';import{jsx as _jsx}from\"react/jsx-runtime\";var CONFIG=require('../conf.json');// Create a context with default values\nconst LoginContext=/*#__PURE__*/createContext({isLoggedIn:false,isAdmin:false,userName:'',email:'',password:'',login:()=>{},logout:()=>{},register:()=>{}});// Create a provider component\nexport const LoginProvider=_ref=>{let{children}=_ref;const[isLoggedIn,setIsLoggedIn]=useState(false);const[isAdmin,setIsAdmin]=useState(false);const[userName,setUserName]=useState('');const[email,setEmail]=useState('');const[password,setPassword]=useState('');const login=async(email,password)=>{try{const response=await $.ajax({url:\"\".concat(CONFIG.ip,\":\").concat(CONFIG.port,\"/user/authenticate\"),type:'POST',dataType:'json',contentType:'application/json',data:JSON.stringify({email:email,password:password})});// console.log(response);\nif(response.status){var user=response.user;localStorage.setItem('user',JSON.stringify({'email':response.user.email,'id':response.user.id,'is_admin':response.user.is_admin,'name':response.user.name}));setIsLoggedIn(true);setIsAdmin(user.is_admin);setUserName(user.name);setEmail(user.email);setPassword(user.password);}else{setIsLoggedIn(false);}return response;}catch(error){console.error('Something Went Wrong:',error);setIsLoggedIn(false);}};const logout=()=>{localStorage.setItem('user',JSON.stringify({email:'',id:null,is_admin:false,name:''}));setIsLoggedIn(false);setIsAdmin(false);};const register=async(username,email,password)=>{try{const response=await $.ajax({url:\"\".concat(CONFIG.ip,\":\").concat(CONFIG.port,\"/user/create\"),type:'POST',dataType:'json',contentType:'application/json',data:JSON.stringify({name:username,email:email,password:password})});return response;}catch(error){console.error('Something Went Wrong:',error);setIsLoggedIn(false);}};useEffect(()=>{// console.log('handler use effect', isLoggedIn, userName);\n},[isLoggedIn,userName]);return/*#__PURE__*/_jsx(LoginContext.Provider,{value:{isLoggedIn,isAdmin,userName,email,password,login,logout,register},children:children});};// Custom hook to consume the LoginContext\nexport const useLogin=()=>{return useContext(LoginContext);};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","$","jsx","_jsx","CONFIG","require","LoginContext","isLoggedIn","isAdmin","userName","email","password","login","logout","register","LoginProvider","_ref","children","setIsLoggedIn","setIsAdmin","setUserName","setEmail","setPassword","response","ajax","url","concat","ip","port","type","dataType","contentType","data","JSON","stringify","status","user","localStorage","setItem","id","is_admin","name","error","console","username","Provider","value","useLogin"],"sources":["/Users/chhornsotheavann/Documents/TripWallet-Frontend/src/js/LoginHandler.js"],"sourcesContent":["import React, { createContext, useContext, useState , useEffect } from 'react';\n\nimport $ from 'jquery'\n\nvar CONFIG = require('../conf.json')\n\n// Create a context with default values\nconst LoginContext = createContext({\n    isLoggedIn: false,\n    isAdmin: false,\n    userName: '',\n    email: '',\n    password: '',\n    login: () => {\n\n    },\n    logout: () => {\n\n    },\n    register: () => {\n\n    }\n});\n\n// Create a provider component\nexport const LoginProvider = ({ children }) => {\n\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\n    const [isAdmin, setIsAdmin] = useState(false);\n    const [userName, setUserName] = useState('');\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n\n\n    const login = async (email, password) => {\n\n        try {\n            const response = await $.ajax({\n                url:`${CONFIG.ip}:${CONFIG.port}/user/authenticate`,\n                type: 'POST',\n                dataType: 'json',\n                contentType: 'application/json',\n                data: JSON.stringify({\n                    email: email,\n                    password: password,\n                }),\n            });\n    \n            // console.log(response);\n    \n            if (response.status) {\n                var user = response.user;\n                localStorage.setItem('user', JSON.stringify({\n                    'email': response.user.email,\n                    'id': response.user.id,\n                    'is_admin': response.user.is_admin,\n                    'name': response.user.name\n                }));\n                setIsLoggedIn(true);\n                setIsAdmin(user.is_admin);\n                setUserName(user.name);\n                setEmail(user.email);\n                setPassword(user.password);\n\n            } else {\n                setIsLoggedIn(false);\n            }\n            return response\n        } catch (error) {\n            console.error('Something Went Wrong:', error);\n            setIsLoggedIn(false);\n        }\n    };\n\n    const logout = () => {\n        localStorage.setItem('user', JSON.stringify({\n            email: '',\n            id: null,\n            is_admin: false,\n            name: '',\n            \n        }));\n        setIsLoggedIn(false);\n        setIsAdmin(false)\n    };\n\n    const register = async (username, email, password) => {\n\n        try {\n            const response = await $.ajax({\n                url: `${CONFIG.ip}:${CONFIG.port}/user/create`,\n                type: 'POST',\n                dataType: 'json',\n                contentType: 'application/json',\n                data: JSON.stringify({\n                    name: username,\n                    email: email,\n                    password: password,\n                }),\n            });\n            return response;\n\n        } catch (error) {\n            console.error('Something Went Wrong:', error);\n            setIsLoggedIn(false);\n        }\n    };\n    \n\n    useEffect(() => {\n        // console.log('handler use effect', isLoggedIn, userName);\n    }, [isLoggedIn, userName]);\n      \n\n    return (\n        <LoginContext.Provider value={{isLoggedIn, isAdmin, userName, email, password, login, logout, register}}>\n            {children}\n        </LoginContext.Provider>\n    );\n};\n\n// Custom hook to consume the LoginContext\nexport const useLogin = () => {\n  return useContext(LoginContext);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}