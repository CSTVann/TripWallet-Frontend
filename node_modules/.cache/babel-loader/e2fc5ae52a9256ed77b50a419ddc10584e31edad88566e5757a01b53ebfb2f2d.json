{"ast":null,"code":"var _jsxFileName = \"/Users/sotheavann/Documents/Project/src/js/LoginHandler.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport $ from 'jquery';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar CONFIG = require('../conf.json');\n\n// Create a context with default values\nconst LoginContext = /*#__PURE__*/createContext({\n  isLoggedIn: false,\n  isAdmin: false,\n  userName: '',\n  email: '',\n  password: '',\n  login: () => {},\n  logout: () => {},\n  register: () => {}\n});\n\n// Create a provider component\nexport const LoginProvider = ({\n  children\n}) => {\n  _s();\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [userName, setUserName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const login = async (email, password) => {\n    try {\n      const response = await $.ajax({\n        url: `${CONFIG.ip}:${CONFIG.port}/user/authenticate`,\n        type: 'POST',\n        dataType: 'json',\n        contentType: 'application/json',\n        data: JSON.stringify({\n          email: email,\n          password: password\n        })\n      });\n\n      // console.log(response);\n\n      if (response.status) {\n        var user = response.user;\n        localStorage.setItem('user', JSON.stringify({\n          'email': response.user.email,\n          'id': response.user.id,\n          'is_admin': response.user.is_admin,\n          'name': response.user.name\n        }));\n        setIsLoggedIn(true);\n        setIsAdmin(user.is_admin);\n        setUserName(user.name);\n        setEmail(user.email);\n        setPassword(user.password);\n      } else {\n        setIsLoggedIn(false);\n      }\n      return response;\n    } catch (error) {\n      console.error('Something Went Wrong:', error);\n      setIsLoggedIn(false);\n    }\n  };\n  const logout = () => {\n    localStorage.setItem('user', JSON.stringify({\n      email: '',\n      id: null,\n      is_admin: false,\n      name: ''\n    }));\n    setIsLoggedIn(false);\n    setIsAdmin(false);\n  };\n  const register = async (username, email, password) => {\n    try {\n      const response = await $.ajax({\n        url: 'http://127.0.0.1:5000/user/create',\n        type: 'POST',\n        dataType: 'json',\n        contentType: 'application/json',\n        data: JSON.stringify({\n          name: username,\n          email: email,\n          password: password\n        })\n      });\n      return response;\n    } catch (error) {\n      console.error('Something Went Wrong:', error);\n      setIsLoggedIn(false);\n    }\n  };\n  useEffect(() => {\n    // console.log('handler use effect', isLoggedIn, userName);\n  }, [isLoggedIn, userName]);\n  return /*#__PURE__*/_jsxDEV(LoginContext.Provider, {\n    value: {\n      isLoggedIn,\n      isAdmin,\n      userName,\n      email,\n      password,\n      login,\n      logout,\n      register\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 9\n  }, this);\n};\n\n// Custom hook to consume the LoginContext\n_s(LoginProvider, \"2SPYe6xeKRAGEACB+b5D0ZXFDJ4=\");\n_c = LoginProvider;\nexport const useLogin = () => {\n  _s2();\n  return useContext(LoginContext);\n};\n_s2(useLogin, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"LoginProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","$","jsxDEV","_jsxDEV","CONFIG","require","LoginContext","isLoggedIn","isAdmin","userName","email","password","login","logout","register","LoginProvider","children","_s","setIsLoggedIn","setIsAdmin","setUserName","setEmail","setPassword","response","ajax","url","ip","port","type","dataType","contentType","data","JSON","stringify","status","user","localStorage","setItem","id","is_admin","name","error","console","username","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useLogin","_s2","$RefreshReg$"],"sources":["/Users/sotheavann/Documents/Project/src/js/LoginHandler.js"],"sourcesContent":["import React, { createContext, useContext, useState , useEffect } from 'react';\n\nimport $ from 'jquery'\n\nvar CONFIG = require('../conf.json')\n\n// Create a context with default values\nconst LoginContext = createContext({\n    isLoggedIn: false,\n    isAdmin: false,\n    userName: '',\n    email: '',\n    password: '',\n    login: () => {\n\n    },\n    logout: () => {\n\n    },\n    register: () => {\n\n    }\n});\n\n// Create a provider component\nexport const LoginProvider = ({ children }) => {\n\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\n    const [isAdmin, setIsAdmin] = useState(false);\n    const [userName, setUserName] = useState('');\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n\n\n    const login = async (email, password) => {\n\n        try {\n            const response = await $.ajax({\n                url:`${CONFIG.ip}:${CONFIG.port}/user/authenticate`,\n                type: 'POST',\n                dataType: 'json',\n                contentType: 'application/json',\n                data: JSON.stringify({\n                    email: email,\n                    password: password,\n                }),\n            });\n    \n            // console.log(response);\n    \n            if (response.status) {\n                var user = response.user;\n                localStorage.setItem('user', JSON.stringify({\n                    'email': response.user.email,\n                    'id': response.user.id,\n                    'is_admin': response.user.is_admin,\n                    'name': response.user.name\n                }));\n                setIsLoggedIn(true);\n                setIsAdmin(user.is_admin);\n                setUserName(user.name);\n                setEmail(user.email);\n                setPassword(user.password);\n\n            } else {\n                setIsLoggedIn(false);\n            }\n            return response\n        } catch (error) {\n            console.error('Something Went Wrong:', error);\n            setIsLoggedIn(false);\n        }\n    };\n\n    const logout = () => {\n        localStorage.setItem('user', JSON.stringify({\n            email: '',\n            id: null,\n            is_admin: false,\n            name: '',\n            \n        }));\n        setIsLoggedIn(false);\n        setIsAdmin(false)\n    };\n\n    const register = async (username, email, password) => {\n\n        try {\n            const response = await $.ajax({\n                url: 'http://127.0.0.1:5000/user/create',\n                type: 'POST',\n                dataType: 'json',\n                contentType: 'application/json',\n                data: JSON.stringify({\n                    name: username,\n                    email: email,\n                    password: password,\n                }),\n            });\n            return response;\n\n        } catch (error) {\n            console.error('Something Went Wrong:', error);\n            setIsLoggedIn(false);\n        }\n    };\n    \n\n    useEffect(() => {\n        // console.log('handler use effect', isLoggedIn, userName);\n    }, [isLoggedIn, userName]);\n      \n\n    return (\n        <LoginContext.Provider value={{isLoggedIn, isAdmin, userName, email, password, login, logout, register}}>\n            {children}\n        </LoginContext.Provider>\n    );\n};\n\n// Custom hook to consume the LoginContext\nexport const useLogin = () => {\n  return useContext(LoginContext);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}